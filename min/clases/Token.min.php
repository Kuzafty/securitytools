<?php class Token{private static function checkSession(){if(session_status()===PHP_SESSION_NONE){session_start();}}public static function create($name){self::checkSession();if(isset($_SESSION[$name])){return false;}$token=bin2hex(random_bytes(32));$_SESSION[$name]=$token;$_SESSION[$name.'_time']=time();return $token;}public static function delete($name){self::checkSession();if(!isset($_SESSION[$name])){return false;}unset($_SESSION[$name]);unset($_SESSION[$name.'_time']);return true;}public static function process($token,$name){self::checkSession();if(!isset($_SESSION[$name])||$token!==$_SESSION[$name]){return false;}self::delete($name);return true;}public static function processTime($token,$name,$time){self::checkSession();if(!isset($_SESSION[$name])||$token!==$_SESSION[$name]){return false;}if((time()-$_SESSION[$name.'_time'])<$time){return false;}self::delete($name);return true;}} ?>