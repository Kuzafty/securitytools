<?php class Ajax{public static function ajax_start($requestType,$contentType){if($_SERVER['REQUEST_METHOD']!==strtoupper($requestType)||!self::is_same_origin()){return false;}header('Content-Type: application/'.$contentType);return true;}private static function is_same_origin(){$origin=isset($_SERVER['HTTP_ORIGIN'])?$_SERVER['HTTP_ORIGIN']:$_SERVER['HTTP_HOST'];return $origin===$_SERVER['HTTP_HOST'];}public static function ajax_error(){http_response_code(400);}public static function ajax_success(){http_response_code(200);}public static function ajax_token(){if(!class_exists('Token')){return false;}$tokenName=isset($_REQUEST['token_name'])?$_REQUEST['token_name']:null;$tokenValue=isset($_REQUEST['token_value'])?$_REQUEST['token_value']:null;$tokenTime=isset($_REQUEST['token_time'])?intval($_REQUEST['token_time']):null;if($tokenName&&$tokenValue){if($tokenTime!==null){return Token::processTime($tokenValue,$tokenName,$tokenTime);}else{return Token::process($tokenValue,$tokenName);}}return false;}} ?>